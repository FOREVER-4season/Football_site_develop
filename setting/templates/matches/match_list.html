{% extends 'base.html' %}
{% block content %}
<div class="container mt-4">

    <!-- âœ… ìº˜ë¦°ë” -->
    <div class="mb-4">
        <div id="inlineCalendar" style="max-width: 800px;"></div>
        <div class="form-text mt-2 text-center">
            ë‚ ì§œë¥¼ ì„ íƒí•˜ë©´ í•´ë‹¹ ë‚ ì§œì˜ ë‚´ ì‹ ì²­ ê²½ê¸°ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤.
        </div>
    </div>

    <!-- âœ… ë‚´ ì‹ ì²­ ë‚´ì—­ -->
    <div class="d-flex flex-column flex-grow-1">
        <h2>ë‚´ ì‹ ì²­ ë‚´ì—­</h2>
        {% if my_matches %}
            {% for m in my_matches %}
                <div class="mb-4 w-100">
                    <div class="card h-100 p-3 shadow-sm">
                        <div class="fw-bold">
                            {{ m.stadium_match.matchtime.start_time.strftime("%mì›” %dì¼ %H:%M") }}
                        </div>
                        <div>
                            ğŸ“ {{ m.stadium_match.stadium.location }} - {{ m.stadium_match.stadium.name }}
                        </div>
                        <div>
                            ğŸ‘¥ ì •ì›: {{ m.stadium_match.stadium.headcount }}ëª… /
                            í˜„ì¬ {{ m.stadium_match.user_matches|length }}ëª… ì‹ ì²­
                        </div>

                        <!-- ìƒì„¸ë³´ê¸° -->
                        <a href="{{ url_for('matches.my_match_detail', usermatch_id=m.usermatch_id) }}"
                           class="btn btn-primary mt-2">ì‹ ì²­ë‚´ì—­ ë³´ê¸°</a>
                    </div>
                </div>
            {% endfor %}
        {% else %}
            <p class="text-center text-muted">
                í•´ë‹¹ ë‚ ì§œì— ì‹ ì²­í•œ ê²½ê¸°ê°€ ì—†ìŠµë‹ˆë‹¤.<br>
                ë‹¤ë¥¸ ë‚ ì§œë¥¼ ì„ íƒí•´ë³´ì„¸ìš”.
            </p>
        {% endif %}
    </div>
</div>

<!-- âœ… Flatpickr ìº˜ë¦°ë” -->
<script>
    document.addEventListener("DOMContentLoaded", function () {
        var today = new Date();
        flatpickr("#inlineCalendar", {
            inline: true,
            dateFormat: "Y-m-d",
            locale: "ko",
            minDate: new Date(today.getFullYear(), today.getMonth() - 6, 1),
            maxDate: new Date(today.getFullYear(), today.getMonth() + 7, 0),
            defaultDate: "{{ selected_date }}",
            onChange: function (selectedDates, dateStr, instance) {
                if (dateStr) {
                    window.location.href = "{{ url_for('matches.my_match_list', user_id=session['user_id']) }}?date=" + dateStr;
                }
            }
        });
    });
</script>
{% endblock %}
